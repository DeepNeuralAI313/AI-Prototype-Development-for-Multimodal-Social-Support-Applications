<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>UAE Financial Aid Portal</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body {
      background-color: #fffbea;
      color: #333;
    }
    .header, .footer {
      background-color: #d4af37;
      color: white;
      padding: 20px;
    }
    .footer {
      margin-top: 50px;
    }
    .card {
      background-color: white;
      border-radius: 12px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      padding: 20px;
      border: 1px solid #d4af37;
    }
    .btn-primary {
      background-color: #d4af37;
      border-color: #d4af37;
      color: white;
    }
    .btn-primary:hover {
      background-color: #c19a2f;
      border-color: #c19a2f;
    }
    .modal-body ul {
      padding-left: 20px;
    }
    .info-box {
      background-color: #fff3cd;
      border: 1px solid #ffeeba;
      padding: 15px;
      border-radius: 10px;
      margin-top: 30px;
    }
  </style>
</head>
<body>

  <!-- Header with logo on the left -->
  <div class="header d-flex align-items-center">
    <!-- <img src="https://w7.pngwing.com/pngs/614/585/png-transparent-dubai-abu-dhabi-emblem-of-the-united-arab-emirates-national-emblem-flag-of-the-united-arab-emirates-uae-emblem-flag-logo-thumbnail.png" alt="UAE Ministry Logo" height="60" class="me-3"> -->
    <div>
      <h2 class="mb-0"> AI Prototype Development for Multimodal Social Support Applications</h2>
      <p class="mb-0">Support for UAE citizens in applying for financial assistance</p>
    </div>
  </div>

  <div class="container mt-5">
   <!-- User Identification -->
   <form id="verifyIDForm" enctype="multipart/form-data">
    <div class="card mb-4">
      <h4>User Identification</h4>
      <label for="userID" class="form-label"  >Enter National ID</label>
      <input type="text" class="form-control" placeholder="784-XXXX-XXXXXXX-X" id="userID" name="userID" required>
  
      <label for="idUpload" class="form-label mt-3">Upload Emirates ID Card</label>
      <input class="form-control" type="file" id="idUpload" name="idUpload" accept="image/*,.pdf" required>
  
      <button type="submit" class="btn btn-primary mt-3">Verify ID</button>
    </div>
  </form>

  <div id="loadingID" style="display:none;" class="text-center">
    <div class="spinner-border text-warning" role="status">
      <span class="visually-hidden">Loading...</span>
    </div>
    <p></p>
  </div>
  <div id="responseMsgID" class="alert mt-3 d-none"></div>
  

  <!-- Salary Verification -->
  <form id="salaryForm" enctype="multipart/form-data">
    <div class="card mb-4">
      <h4>Salary Verification</h4>

      <label for="userSalary" class="form-label"  >Enter Salary</label>
      <input type="number" class="form-control" placeholder="XXXX-AED" id="userSalary" name="userSalary" required>
  
      <label for="salarySlip" class="form-label">Upload Salary Slip</label>
      <input class="form-control" type="file" id="salarySlip" name="salarySlip" accept="image/*,.pdf" required>
  
      <button type="submit" class="btn btn-primary mt-3">Submit Salary Info</button>
    </div>
  </form>
  
  <div id="loadingSalary" style="display:none;" class="text-center">
    <div class="spinner-border text-warning" role="status">
      <span class="visually-hidden">Loading...</span>
    </div>
    <p></p>
  </div>
  <div id="responseMsgSalary" class="alert mt-3 d-none"></div>
  

  <!-- Final Application Submission -->
  <form id="finalForm" dir="rtl">
    <div class="card mb-4">
      <div class="row">
        <div class="col-md-4">
          <label for="age" class="form-label">العمر (Age)</label>
          <input type="number" class="form-control" id="age" name="age" required>
        </div>
        <div class="col-md-4">
          <label for="sex" class="form-label">الجنس (Gender)</label>
          <select class="form-select" id="sex" name="sex" required>
            <option value="ذكر">ذكر</option>
            <option value="أنثى">أنثى</option>
          </select>
        </div>
        <div class="col-md-4">
          <label for="familySize" class="form-label">عدد أفراد الأسرة (Family Members)</label>
          <input type="number" class="form-control" id="familySize" name="familySize" required>
        </div>
      </div>
    </div>
  
    <div class="card mb-4">
      <div class="row">
        <div class="col-md-4">
          <label for="employmentStatus" class="form-label">الحالة الوظيفية (Employment Status)</label>
          <select class="form-select" id="employmentStatus" name="employmentStatus" required>
            <option value="موظف">موظف</option>
            <option value="عاطل عن العمل">عاطل عن العمل</option>
            <option value="عمل حر">عمل حر</option>
            <option value="دوام جزئي">دوام جزئي</option>
            <option value="متعاقد">متعاقد</option>
            <option value="متقاعد">متقاعد</option>


          </select>
        </div>
        <div class="col-md-4">
          <label for="educationLevel" class="form-label">المستوى التعليمي (Education Level)</label>
          <select class="form-select" id="educationLevel" name="educationLevel" required>
            <option value="دكتوراه">دكتوراه</option>
            <option value="ماجستير">ماجستير</option>
            <option value="بكالوريوس">بكالوريوس</option>
            <option value="الثانوية العامة">الثانوية العامة</option>
          
          </select>
        </div>
        <div class="col-md-4">
          <label for="region" class="form-label">المنطقة (Region)</label>
          <select class="form-select" id="region" name="region" required>
            <option value="">اختر المنطقة (Select a region)</option>
            <option value="أبوظبي">أبوظبي</option>
            <option value="الشارقة">الشارقة</option>
            <option value="دبي">دبي</option>
            <option value="الفجيرة">الفجيرة</option>
            <option value="أس الخيمة">أس الخيمة</option>
            <option value="أم القيوين">أم القيوين</option>
  
          </select>
        </div>
      </div>
    </div>
  
    <div class="card mb-4">
      <div class="row">
        <div class="col-md-6">
          <label for="creditScore" class="form-label">درجة الائتمان (Credit Score)</label>
          <input type="number" class="form-control" id="creditScore" name="creditScore" required>
        </div>
        <div class="col-md-6 d-flex align-items-end">
          <button type="button" class="btn btn-primary w-100" data-bs-toggle="modal" data-bs-target="#submissionModal">
            تقديم الطلب (Submit Application)
          </button>
        </div>
      </div>
    </div>
  
    <div class="modal fade" id="submissionModal" tabindex="-1" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">شروط الأهلية للتقديم (Application Criteria for Eligibility)</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
          </div>
          <div class="modal-body">
            <p>لكي تكون مؤهلاً (To be eligible):</p>
            <ul>
              <li>أن تكون مواطنًا إماراتيًا يحمل بطاقة هوية إماراتية سارية (UAE National with valid Emirates ID)</li>
              <!-- <li>درجة الائتمان أقل من 600 (Credit Score below 600)</li> -->
              <li>عدد أفراد الأسرة 4 أو أكثر (Family size of 4 or more)</li>
              <li>عاطل عن العمل أو الدخل أقل من 10,000 درهم (Unemployed or income below AED 10,000)</li>
            </ul>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">إغلاق (Close)</button>
            <button type="submit" class="btn btn-primary">تأكيد التقديم (Confirm Submission)</button>
          </div>
        </div>
      </div>
    </div>
  </form>
  
  
  <div id="loadingFinal" style="display:none;" class="text-center">
    <div class="spinner-border text-warning" role="status">
      <span class="visually-hidden">Loading...</span>
    </div>
    <p></p>
  </div>
  <div id="responseMsgFinal" class="alert mt-3 d-none"></div>
  
<!-- Final Submission Result -->
<div id="finalSubmissionResult" class="card p-3  d-none">
    <h4 class="mb-3">🎉 Submission Result</h4>
    <p><strong>Name:</strong> <span id="submittedName"></span></p>
    <p><strong>Emirates ID:</strong> <span id="submittedID"></span></p>
    <p><strong>Score:</strong> <span id="submittedScore"></span></p>
    <p><strong>Aid Amount:</strong> AED <span id="submittedAid"></span> month</p>
  </div>
    <!-- Footer -->
    <div class="footer text-center">
      <p class="mb-0">&copy; 2025 UAE Ministry of Social Support & Development. All Rights Reserved.</p>
    </div>



 
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    async function handleFormSubmission(formId, endpoint, loadingId, messageId, loadingText) {
      const form = document.getElementById(formId);
      const formData = new FormData(form);
      const loading = document.getElementById(loadingId);
      const responseMsg = document.getElementById(messageId);
    
  
      // Set custom loading message
      loading.querySelector("p").textContent = loadingText;
      loading.style.display = 'block';
      responseMsg.classList.add('d-none');
  
      const res = await fetch(endpoint, {
        method: 'POST',
        body: formData
      });
  
      const result = await res.json();
      loading.style.display = 'none';
  
      responseMsg.textContent = result.message;
      responseMsg.className = `alert mt-3 alert-${result.status === 'success' ? 'success' : 'danger'}`;
      responseMsg.classList.remove('d-none');
    
      if (formId === 'finalForm' && result.status === 'success') {
        const submissionData = result.data;

        document.getElementById("finalSubmissionResult").classList.remove("d-none");
        document.getElementById("submittedName").textContent = submissionData.Name;
        document.getElementById("submittedID").textContent = submissionData.Emirates_ID;
        document.getElementById("submittedScore").textContent = submissionData.Score;
        document.getElementById("submittedAid").textContent = submissionData.Aid_Amount;
        document.getElementById("responseMsgFinal").innerHTML = `<span class="text-success">${result.message}</span>`;
        }

      // If verifying Emirates ID and it's successful, fill and lock fields
      if (formId === 'verifyIDForm' && result.status === 'success') {
        const data = result.user_data;
  
        document.getElementById("age").value = data.Age;
        document.getElementById("sex").value = data.Gender.toLowerCase();
        document.getElementById("familySize").value = data.Dependents;
        document.getElementById("employmentStatus").value = data.Employment_Status.toLowerCase();
        document.getElementById("educationLevel").value = data.Education_Level.toLowerCase().replace(/\s+/g, "-");
        document.getElementById("region").value = data.Region.toLowerCase().replace(/\s+/g, "-");
        document.getElementById("creditScore").value = data.Credit_Score;
        // Lock the inputs
        ["age", "sex", "familySize", "employmentStatus", "educationLevel", "region", "creditScore"].forEach(id => {
          const el = document.getElementById(id);
          if (el.tagName === "SELECT") {
            el.disabled = true;
          } else {
            el.readOnly = true;
          }
        });
      }
    }
  
    document.getElementById('verifyIDForm').addEventListener('submit', function(e) {
      e.preventDefault();
      handleFormSubmission(
        'verifyIDForm',
        '/verify_id',
        'loadingID',
        'responseMsgID',
        'Scanning your Emirates ID and verifying your national record...'
      );
    });
  
    document.getElementById('salaryForm').addEventListener('submit', function(e) {
      e.preventDefault();
      handleFormSubmission(
        'salaryForm',
        '/submit_salary',
        'loadingSalary',
        'responseMsgSalary',
        'Validating your salary information. Please wait...'
      );
    });
  
    document.getElementById('finalForm').addEventListener('submit', function(e) {
      e.preventDefault();
      handleFormSubmission(
        'finalForm',
        '/final_submit',
        'loadingFinal',
        'responseMsgFinal',
        'Submitting your full application. This may take a moment...'
      );
    });
  </script>
  
  
</body>
</html>
